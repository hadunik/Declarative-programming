4.1
SELECT p.WARE
from (SELECT WARE, avg(PRICE) 
from PRODUCT
GROUP BY PRODUCT.WARE
ORDER BY avg(price) DESC) p
limit 1

4.2
SELECT a.CLASS, max(p1.WARE)
FROM (SELECT c.CLASS, c.WARE, max(p.PRICE) as maxi
	FROM CATEGORY c,PRODUCT p
	WHERE c.WARE = p.WARE
	GROUP BY c.CLASS, c.WARE) a, 
	PRODUCT p1
WHERE p1.WARE = a.WARE AND p1.PRICE = a.maxi
GROUP BY a.CLASS
HAVING p1.PRICE = maxi
ORDER BY a.CLASS

4.3
SELECT DISTINCT C.CLASS, P.PRICE, P.WARE
FROM PRODUCT P, CATEGORY C
WHERE P.WARE = C.WARE AND P.PRICE = (SELECT MAX(P1.PRICE) 
				FROM PRODUCT P1, CATEGORY C1 
				WHERE P1.WARE = C1.WARE AND C1.CLASS = C.CLASS)
4.4
SELECT DISTINCT a1.COMPANY
FROM (SELECT m.COMPANY, p1.WARE, avg(p1.PRICE) as price_com
FROM MANUFACTURER m, PRODUCT p1
WHERE p1.BILL_ID = m.BILL_ID 
GROUP BY m.COMPANY, p1.WARE) a1,
(SELECT p.WARE , avg(p.PRICE) as price_stand
from PRODUCT p
GROUP BY p.WARE) a2
WHERE a1.WARE = a2.WARE
GROUP BY a1.COMPANY
HAVING min(price_com/price_stand) > 1.2 


4.5
SELECT a1.COMPANY, a1.CLASS, a1.lis
FROM (SELECT c.CLASS, count(distinct p.WARE) as cnt, group_concat(DISTINCT p.ware) as lis
	FROM PRODUCT p, CATEGORY c, MANUFACTURER m
	WHERE p.BILL_ID = m.BILL_ID AND p.WARE = c.WARE
	GROUP BY m.COMPANY, c.CLASS) a1
, 
	(SELECT c1.CLASS, count(c1.WARE) as std_cnt
	FROM CATEGORY c1
	GROUP BY c1.CLASS) a2
WHERE a1.CLASS = a2.CLASS and a1.cnt = a2.std_cnt

ORDER BY a1.CLASS

4.6
SELECT MIN(COMPANY),
	(SELECT group_concat(WARE) 
		FROM MATERIAL M
		WHERE M.BILL_ID = MANUFACTURER.BILL_ID) AS MATS,
	(SELECT group_concat(WARE) 
		FROM PRODUCT P
		WHERE P.BILL_ID = MANUFACTURER.BILL_ID) AS PRODS,
	(SELECT SUM(PRICE * AMOUNT) 
		FROM PRODUCT P
		WHERE P.BILL_ID = MANUFACTURER.BILL_ID) AS TOTAL_PRICE
FROM MANUFACTURER 
GROUP BY BILL_ID
ORDER BY COMPANY;

(другой вариант
/*
SELECT MIN(COMPANY),
	(SELECT group_concat(WARE) 
		FROM MATERIAL M
		WHERE M.BILL_ID = MANUFACTURER.BILL_ID) AS MATS,
	group_concat(WARE) AS PRODS,
	sum(PRICE * AMOUNT) AS TOTAL_PRICE
FROM MANUFACTURER JOIN PRODUCT ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
GROUP BY MANUFACTURER.BILL_ID
ORDER BY COMPANY;
*/)
